<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>BitSurvey</title>
  <script src="/bins/jquery.js"></script>
  <script src="/bins/jquery-ui.js"></script>
  <link rel="stylesheet" href="/bins/jquery-ui.css">
  <link rel="stylesheet" href="/bins/style.css">
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="/bins/functions.js"></script>
</head>
<body>
<div id="scenario1" class="scenario">
    <h1>Scenario 1</h1>
    <div class="list darkbg" id="situation1_bin-default">
        <h1>Behaviours</h1>
        <ul class="droptrue sortable1">
          <li class="floater" value="0">Behaviour 1</li>
          <li class="floater" value="1">Behaviour 2</li>
          <li class="floater" value="2">Behaviour 3</li>
          <li class="floater" value="3">Behaviour 4</li>
          <li class="floater" value="4">Behaviour 5</li>
          <li class="floater" value="5">Behaviour 6</li>
          <li class="floater" value="6">Behaviour 7</li>
          <li class="floater" value="7">Behaviour 8</li>
        </ul>
    </div>

    <div class="list" id="situation1_bin-2">
        <h1><span id="match">Mismatch</span><br/>-2</h1>
        <ul class="droptrue sortable1" id="situation1_bin-2">
        </ul>
    </div>
    <div class="list" id="situation1_bin-1">
        <h1><br/>-1</h1>
        <ul class="droptrue sortable1" id="situation1_bin-1">
        </ul>
    </div>
    <div class="list" id="situation1_bin-0">
        <h1><br/>0</h1>
        <ul class="droptrue sortable1" id="situation1_bin-0">
        </ul>
    </div>
    <div class="list" id="situation1_bin+1">
        <h1><br/>1</h1>
        <ul class="droptrue sortable1" id="situation1_bin+1">
        </ul>
    </div>
    <div class="list" id="situation1_bin+2">
        <h1><span id="match">Match</span><br/>2</h1>
        <ul class="droptrue sortable1" id="situation1_bin+2">
        </ul>
    </div>
</div>
<div id="scenario2" class="scenario">
    <h1>Scenario 2</h1>
    <div class="list darkbg" id="situation2_bin-default">
        <h1>Behaviours</h1>
        <ul class="droptrue sortable1">
          <li class="floater" value="0">Behaviour 1</li>
          <li class="floater" value="1">Behaviour 2</li>
          <li class="floater" value="2">Behaviour 3</li>
          <li class="floater" value="3">Behaviour 4</li>
          <li class="floater" value="4">Behaviour 5</li>
          <li class="floater" value="5">Behaviour 6</li>
          <li class="floater" value="6">Behaviour 7</li>
          <li class="floater" value="7">Behaviour 8</li>
        </ul>
    </div>

    <div class="list" id="situation2_bin-2">
        <h1><span id="match">Mismatch</span><br/>-2</h1>
        <ul class="droptrue sortable1" id="situation2_bin-2">
        </ul>
    </div>
    <div class="list" id="situation2_bin-1">
        <h1><br/>-1</h1>
        <ul class="droptrue sortable1" id="situation2_bin-1">
        </ul>
    </div>
    <div class="list" id="situation2_bin-0">
        <h1><br/>0</h1>
        <ul class="droptrue sortable1" id="situation2_bin-0">
        </ul>
    </div>
    <div class="list" id="situation2_bin+1">
        <h1><br/>1</h1>
        <ul class="droptrue sortable1" id="situation2_bin+1">
        </ul>
    </div>
    <div class="list" id="situation2_bin+2">
        <h1><span id="match">Match</span><br/>2</h1>
        <ul class="droptrue sortable1" id="situation2_bin+2">
        </ul>
    </div>
</div>
<div id="scenario3" class="scenario">
    <h1>Scenario 3</h1>
    <div class="list darkbg" id="situation3_bin-default">
        <h1>Behaviours</h1>
        <ul class="droptrue sortable1">
          <li class="floater" value="0">Behaviour 1</li>
          <li class="floater" value="1">Behaviour 2</li>
          <li class="floater" value="2">Behaviour 3</li>
          <li class="floater" value="3">Behaviour 4</li>
          <li class="floater" value="4">Behaviour 5</li>
          <li class="floater" value="5">Behaviour 6</li>
          <li class="floater" value="6">Behaviour 7</li>
          <li class="floater" value="7">Behaviour 8</li>
        </ul>
    </div>

    <div class="list" id="situation3_bin-2">
        <h1><span id="match">Mismatch</span><br/>-2</h1>
        <ul class="droptrue sortable1" id="situation3_bin-2">
        </ul>
    </div>
    <div class="list" id="situation3_bin-1">
        <h1><br/>-1</h1>
        <ul class="droptrue sortable1" id="situation3_bin-1">
        </ul>
    </div>
    <div class="list" id="situation3_bin-0">
        <h1><br/>0</h1>
        <ul class="droptrue sortable1" id="situation3_bin-0">
        </ul>
    </div>
    <div class="list" id="situation3_bin+1">
        <h1><br/>1</h1>
        <ul class="droptrue sortable1" id="situation3_bin+1">
        </ul>
    </div>
    <div class="list" id="situation3_bin+2">
        <h1><span id="match">Match</span><br/>2</h1>
        <ul class="droptrue sortable1" id="situation3_bin+2">
        </ul>
    </div>
</div>
<div id="scenario4" class="scenario">
    <h1>Scenario 4</h1>
    <div class="list darkbg" id="situation4_bin-default">
        <h1>Behaviours</h1>
        <ul class="droptrue sortable1">
          <li class="floater" value="0">Behaviour 1</li>
          <li class="floater" value="1">Behaviour 2</li>
          <li class="floater" value="2">Behaviour 3</li>
          <li class="floater" value="3">Behaviour 4</li>
          <li class="floater" value="4">Behaviour 5</li>
          <li class="floater" value="5">Behaviour 6</li>
          <li class="floater" value="6">Behaviour 7</li>
          <li class="floater" value="7">Behaviour 8</li>
        </ul>
    </div>

    <div class="list" id="situation4_bin-2">
        <h1><span id="match">Mismatch</span><br/>-2</h1>
        <ul class="droptrue sortable1" id="situation4_bin-2">
        </ul>
    </div>
    <div class="list" id="situation4_bin-1">
        <h1><br/>-1</h1>
        <ul class="droptrue sortable1" id="situation4_bin-1">
        </ul>
    </div>
    <div class="list" id="situation4_bin-0">
        <h1><br/>0</h1>
        <ul class="droptrue sortable1" id="situation4_bin-0">
        </ul>
    </div>
    <div class="list" id="situation4_bin+1">
        <h1><br/>1</h1>
        <ul class="droptrue sortable1" id="situation4_bin+1">
        </ul>
    </div>
    <div class="list" id="situation4_bin+2">
        <h1><span id="match">Match</span><br/>2</h1>
        <ul class="droptrue sortable1" id="situation4_bin+2">
        </ul>
    </div>
</div>

<div class="confirmselection">
	<!-- <button type="confirm_behavior1" onclick="location.href='index2.html'; getSelectedButton();" form="form1" value="Confirm">Confirm</button> -->
	<button type="confirm_behavior1" onclick="confirmSelections();" form="form1" value="Confirm">Confirm selections</button>
</div>

<script>
	var socket = io('http://localhost:8080');
	// query situation for index x from server, add to page header
	socket.emit('query_situation', '3');

	var moved_behavior;
	var bin_start;
	var bin_end;
	var situation;
	
	$(document).ready(function(){
		$('[class^=floater]').click(function(){
			situation = $(this).closest("div").attr("id");
			var played = $(this).attr("value");
			playTestBehaviour(played, situation);
			console.log("Played behaviour " + played + ": " + situation);
		});		
	});
	
	$('[class^=floater]').mousedown(function(){
		situation = $(this).closest("div").attr("id");
		moved_behavior = $(this).attr("value");			
		//console.log("mouse down: " + situation + " " + b_number);
	});
	
	$('[class^=floater]').mouseup(function(){
		bin_start = $(this).closest("div").attr("id");
		moved_behavior = $(this).attr("value");			
		//console.log("moving " + moved_behavior + " from  " + situation);
	});	
	
	$(function() {
		//$("#floater").draggable();
		$('[id^=situation]').droppable({
			drop: function(event, ui) {
				bin_end = event.target.id;
				console.log("Dragged behaviour " + moved_behavior + ": " + bin_start + " -> " + bin_end);
			}
		});
	});
	
	function confirmSelections() {
		var x = $(".floater");
		for (var i = 0; i < x.length; i++) {
			var answer = x[i].parentNode.getAttribute("id");
			console.log(x[i].innerHTML + ": " + x[i].parentNode.getAttribute("id"));
			if (answer == null) {
				alert("Please drag each behaviour to a bin before confirming selections.");
			}
		}
	}
</script>

</body>
</html>
	